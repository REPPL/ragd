# Milestone: v0.7.0 - Privacy Core

Core privacy controls for sensitive documents.

## Goal

Implement foundational privacy features for users with sensitive documents. Database encryption, session management, secure deletion, and PII detection ensure ragd is trustworthy for personal and professional use.

## Theme

**"Trust Your Tools"** - Privacy by design, not afterthought.

## Use Cases Addressed

| Use Case | Description | Status |
|----------|-------------|--------|
| Encrypted Storage | Protect data at rest | ✅ Done |
| Session Privacy | Auto-lock and key protection | ✅ Done |
| Secure Deletion | Properly remove sensitive data | ✅ Done |
| PII Protection | Detect personal information before indexing | ✅ Done |

## Preliminary Features (Completed)

Chat enhancements implemented before Privacy Core:

| Feature | Description | Priority | Status |
|---------|-------------|----------|--------|
| [F-065](../features/completed/F-065-chat-citation-display.md) | Chat Citation Display | P1 | ✅ Done |
| [F-066](../features/completed/F-066-configurable-chat-prompts.md) | Configurable Chat Prompts | P2 | ✅ Done |

## Privacy Core Features

| Feature | Description | Priority | Status |
|---------|-------------|----------|--------|
| [F-015](../features/completed/F-015-database-encryption.md) | Database Encryption | P0 | ✅ Done |
| [F-016](../features/completed/F-016-session-management.md) | Session Management | P0 | ✅ Done |
| [F-017](../features/completed/F-017-secure-deletion.md) | Secure Deletion | P1 | ✅ Done |
| [F-023](../features/completed/F-023-pii-detection.md) | PII Detection | P1 | ✅ Done |

## Deferred to v0.7.5 (Privacy Polish + Tagging)

The following features were originally scoped for v0.7.0 but deferred to maintain focused delivery:

| Feature | Description | Reason |
|---------|-------------|--------|
| [F-018](../features/planned/F-018-data-tiers.md) | Data Sensitivity Tiers | Extends encryption foundation |
| [F-064](../features/planned/F-064-tag-provenance.md) | Tag Provenance | Schema foundation for tagging |
| [F-061](../features/planned/F-061-auto-tag-suggestions.md) | Auto-Tag Suggestions | Depends on F-064 |
| [F-062](../features/planned/F-062-tag-library-management.md) | Tag Library Management | Depends on F-061 |
| [F-063](../features/planned/F-063-smart-collections.md) | Smart Collections | Independent tagging feature |

## Deferred to v0.8.0 (Storage Strategy)

Storage architecture decisions requiring further design:

| Feature | Description | Notes |
|---------|-------------|-------|
| Dual-Index Architecture | Index both ChromaDB + FAISS | Query-aware backend selection |
| Smart Backend Router | Dynamic backend selection | Based on query characteristics |
| [F-075](../features/planned/F-075-backend-migration-tool.md) | Backend Migration Tool | Alternative if dual-index not chosen |
| F-022 | Knowledge Graph Integration | Original v0.8 feature (Kuzu) |

## Dependencies

- **v0.6.6** - Storage abstraction + polish complete (encryption integrates with adapters)

## Technology Stack

| Component | Technology |
|-----------|------------|
| Key Derivation | Argon2id (64MB, 3 iterations, 4 parallel) |
| Encryption | SQLCipher (AES-256-GCM) |
| PII Detection | Presidio + spaCy (offline) |
| Secure Deletion | Standard / Secure overwrite / Cryptographic erasure |
| Memory Protection | mlock() attempt, ctypes.memset for clearing |

## Success Criteria

- [x] Database encrypted at rest with AES-256-GCM (F-015)
- [x] Session auto-locks after configurable timeout (F-016)
- [x] Keys cleared from memory on lock (F-016)
- [x] Secure deletion with three levels works correctly (F-017)
- [x] Deletion audit log maintained (F-017)
- [x] PII detected before indexing with user prompts (F-023)
- [x] No external data transmission (fully offline)
- [x] Performance overhead acceptable (<15% encryption, <20% PII)
- [x] All tests pass, coverage ≥80%

## Non-Goals for v0.7.0

- Data sensitivity tiers → v0.7.5
- PII redaction in source documents → Manual process
- Key escrow → Never
- Cloud backup → Never (user controls data)
- Web UI → v1.0

## Draft Release Notes

### ragd v0.7.0 - Privacy Core

**Trust your tools.**

Your documents are personal. ragd now has foundational privacy features to protect your data.

**Chat Improvements:**

- **Chat Citation Display** (F-065) - Citations now displayed after chat responses with `--cite` flag
- **Configurable Chat Prompts** (F-066) - Customise citation instructions via `config.yaml`

**Privacy Features:**

- **Database Encryption** (F-015) - AES-256-GCM encryption at rest with Argon2id key derivation
- **Session Management** (F-016) - Auto-lock after timeout, key protection in memory
- **Secure Deletion** (F-017) - Three-level deletion: standard, secure overwrite, cryptographic erasure
- **PII Detection** (F-023) - Identify personal information before indexing with Presidio

**Getting Started:**

```bash
# Initialise with encryption (prompted for password)
ragd init
Enter password: ********
Confirm password: ********
✓ Database initialised with encryption

# Unlock session
ragd unlock
Enter password: ********
✓ Session unlocked for 5 minutes

# Scan for PII before indexing
ragd index ~/Documents/contracts/ --scan-pii

# Lock session immediately
ragd lock

# Securely delete document
ragd delete document.pdf --secure

# Maximum security deletion with key rotation
ragd delete sensitive.pdf --purge
```

**What's Next:**

- v0.7.5 brings data sensitivity tiers, tag provenance, and smart collections
- v0.8.0 brings storage strategy decisions and knowledge graph integration

---

## Related Documentation

**Milestones:**
- [v0.6.6 - Polish & Stability](./v0.6.5.md) - Prerequisite milestone
- [v0.7.5 - Privacy Polish + Tagging](./v0.7.5.md) - Next milestone (planned)

**Feature Specifications:**
- [F-015: Database Encryption](../features/completed/F-015-database-encryption.md)
- [F-016: Session Management](../features/completed/F-016-session-management.md)
- [F-017: Secure Deletion](../features/completed/F-017-secure-deletion.md)
- [F-023: PII Detection](../features/completed/F-023-pii-detection.md)
- [F-065: Chat Citation Display](../features/completed/F-065-chat-citation-display.md)
- [F-066: Configurable Chat Prompts](../features/completed/F-066-configurable-chat-prompts.md)

**Research:**
- [State-of-the-Art Privacy](../research/state-of-the-art-privacy.md)
- [State-of-the-Art PII Removal](../research/state-of-the-art-pii-removal.md)

**Architecture:**
- [ADR-0009: Security Architecture](../decisions/adrs/0009-security-architecture.md)
- [ADR-0028: PII Handling Architecture](../decisions/adrs/0028-pii-handling-architecture.md)

---

**Status**: Released
