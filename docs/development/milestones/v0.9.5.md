# Milestone: v0.9.5 - Stability & Logging

Early adopter release with exceptional stability and comprehensive logging.

## Theme

**"Ready for Early Adopters"** - Stable, observable, scriptable.

## Features Planned

| ID | Feature | Description | Status |
|----|---------|-------------|--------|
| [F-110](../features/planned/F-110-structured-logging.md) | Structured Logging | JSON logs, log levels, rotation, third-party suppression | ðŸ“‹ Planned |
| [F-111](../features/planned/F-111-error-logging-recovery.md) | Error Logging & Recovery | Per-document stats, failure categories, remediation hints | ðŸ“‹ Planned |
| F-112 | Operation Audit Trail | Log all operations with timestamps | ðŸ“‹ Planned |
| F-113 | Exit Codes & Status | Consistent exit codes for scripting | ðŸ“‹ Planned |
| [F-114](../features/planned/F-114-cli-user-feedback.md) | CLI User Feedback | Clean progress, quality stats, named failures | ðŸ“‹ Planned |
| F-115 | Source Quality Scoring | Confidence scores for content | ðŸ“‹ Planned |
| F-116 | Index Integrity Checks | `ragd doctor` command | ðŸ“‹ Planned |
| F-117 | Self-Healing Index | Auto-repair common issues | ðŸ“‹ Planned |
| F-118 | Dry-Run Mode | `--dry-run` for destructive ops | ðŸ“‹ Planned |

## Focus Areas

### Clean CLI Output (F-110, F-114)

The primary goal is a noise-free indexing experience:

```
Indexing 2,183 documents...

[=================>          ] 1,284/2,183 (59%) | report-q3.pdf

Processing: 12 docs/sec | Elapsed: 1m 42s | ETA: 1m 10s
```

Third-party warnings (tokenizers, PaddleOCR, transformers) are suppressed from console but captured in log files.

### Per-Document Statistics (F-111, F-114)

Final summary shows named files with failure reasons:

```
+-- Indexing Complete ------------------------------------------------+
|                                                                      |
|  Documents:  2,145 indexed | 30 skipped | 8 failed                  |
|  Content:    45,231 chunks | 12,847 pages                           |
|  Quality:    98.2% extraction success                               |
|                                                                      |
|  Time: 3m 24s | Rate: 10.5 docs/sec                                 |
+----------------------------------------------------------------------+

Partial extractions (3 documents):
  scanned-form.pdf         87% (13/15 pages) - 2 pages failed OCR
  old-report.pdf           92% (23/25 pages) - low confidence
  faded-scan.pdf           78% (7/9 pages)   - below threshold

Failed documents (8):
  encrypted-file.pdf       ENCRYPTED - Remove password protection
  scan-only.pdf            IMAGE_ONLY - Install: pip install 'ragd[ocr]'
  corrupted.pdf            MALFORMED - File may be corrupted

Detailed log: ~/.ragd/logs/ragd_2024-12-04_05-34-20.jsonl
```

### Structured Logging (F-110, F-111, F-112)
```bash
# Enable structured logging
ragd index --log-file indexing.log --log-level DEBUG

# Log format (JSON lines)
{"timestamp": "2024-12-04T06:30:00Z", "level": "INFO", "operation": "index",
 "file": "paper.pdf", "chunks": 42, "duration_ms": 1234}

# Query logs
ragd logs show --since "1 hour ago" --level ERROR
```

### Exit Codes (F-113)

| Code | Meaning |
|------|---------|
| 0 | Success |
| 1 | General error |
| 2 | Usage error |
| 3 | Config error |
| 4 | Dependency error |
| 5 | Partial success |

### Index Health System (F-116, F-117)
```bash
# Check index integrity
ragd doctor
# âœ“ Vector store: 12,345 vectors
# âš  Orphaned vectors: 23
# âœ— Missing vectors: 5

# Auto-repair
ragd doctor --fix

# Dry-run before destructive operations
ragd delete --all --dry-run
```

### CLI User Feedback (F-114)
- Progress indicators for long operations
- Descriptive error messages
- Actionable hints with errors
- Colour-coded output (errors=red, success=green)
- `--no-color` flag for scripting

## Success Criteria

- [ ] Zero crashes on malformed input
- [ ] All operations loggable
- [ ] Consistent exit codes
- [ ] 85%+ test coverage
- [ ] `ragd doctor` detects and repairs issues
- [ ] Every error includes remediation hint

## Dependencies

- v0.9.1 (CLI Polish & Documentation II)

## Prerequisites

- ADR-0017: CLI Output Contracts
- ADR-0018: Logging Architecture

---

## Related Documentation

- [v0.9.1 Milestone](./v0.9.1.md) - Previous release
- [v0.9.6 Milestone](./v0.9.6.md) - Next planned release
- [Feature Roadmap](../features/README.md)

---

**Status**: Planned
