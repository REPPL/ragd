# Milestone: v0.4.1 - Boolean Search

Enhanced search with boolean operators for precise queries.

## Goal

Add boolean operator support (AND, OR, NOT, parentheses, phrases, prefix wildcards) to ragd's keyword search, enabling users to construct precise queries for finding exactly what they need.

## Theme

**"Precision Search"** - Find exactly what you need, exclude what you don't.

## Features Included

| Feature | Description | Status |
|---------|-------------|--------|
| Boolean Operators | AND, OR, NOT support in keyword search | ✅ Complete |
| Phrase Search | Exact phrase matching with quotes | ✅ Complete |
| Prefix Wildcards | Match word prefixes with `*` | ✅ Complete |
| Query Validation | User-friendly error messages | ✅ Complete |
| Graceful Fallback | Invalid queries fall back to simple search | ✅ Complete |

## Implementation Details

### Query Parser Module

New module: `src/ragd/search/query/`

| File | Purpose |
|------|---------|
| `ast.py` | AST dataclasses (TermNode, BinaryNode, etc.) |
| `parser.py` | pyparsing grammar for boolean queries |
| `transformer.py` | FTS5 query syntax generation |
| `validator.py` | Query validation with warnings |
| `errors.py` | User-friendly error messages |
| `__init__.py` | Public API: `parse_query()` |

### Supported Syntax

```
AND    Both terms required       "python AND testing"
OR     Either term matches       "ML OR machine learning"
NOT    Exclude term              "web NOT Django"
()     Group expressions         "(A OR B) AND C"
""     Exact phrase              "machine learning"
*      Prefix match              "mach*"
```

### Integration

- BM25 search automatically uses boolean parsing
- Semantic search unchanged (original query text)
- CLI help text updated with boolean examples
- Error handling with position pointers and suggestions

## Dependencies

- **v0.4.0** - Multi-Modal must be complete
- **pyparsing** - Already available (pip-requirements-parser dependency)

## Success Criteria

- [x] AND operator correctly requires both terms
- [x] OR operator matches either term
- [x] NOT operator excludes results
- [x] Phrase search finds exact matches
- [x] Prefix wildcards match word beginnings
- [x] Grouped expressions evaluate correctly
- [x] Error messages are user-friendly
- [x] Invalid queries fall back gracefully
- [x] All existing tests continue to pass
- [x] New tests cover boolean functionality

## Test Coverage

- **45 unit tests** in `test_query_parser.py`
- **9 integration tests** in `test_hybrid_search.py` (TestBM25BooleanOperators)

## Documentation

| Document | Location |
|----------|----------|
| Tutorial | `docs/tutorials/powerful-searching.md` |
| Reference | `docs/reference/search-syntax.md` |
| CLI Help | `ragd search --help` |

## Release Notes

### ragd v0.4.1 - Boolean Search

**Find precisely what you need.**

ragd now supports boolean search operators for surgical precision in your queries.

**New Features:**

- **Boolean Operators** - AND, OR, NOT for precise queries
- **Phrase Search** - Find exact phrases with quotes
- **Prefix Wildcards** - Match word beginnings with `*`
- **Grouped Expressions** - Control precedence with parentheses
- **Helpful Errors** - Clear messages when queries have issues

**Getting Started:**

```bash
# Boolean operators work best in keyword mode
ragd search "Python AND testing" --mode keyword
ragd search "ML OR AI" --mode keyword
ragd search "web NOT deprecated" --mode keyword

# Exact phrases
ragd search '"machine learning"' --mode keyword

# Complex queries
ragd search '(Python OR Java) AND "API design"' --mode keyword
```

**What's Next:**

v0.5 focuses on Chat: conversational interface with local LLM integration.

---

## Related Documentation

- [v0.4.0 - Multi-Modal](./v0.4.0.md) - Prerequisite milestone
- [v0.5.0 - Chat](./v0.5.0.md) - Next milestone
- [Tutorial: Powerful Searching](../../tutorials/powerful-searching.md)
- [Reference: Search Syntax](../../reference/search-syntax.md)

---

**Status**: Complete
