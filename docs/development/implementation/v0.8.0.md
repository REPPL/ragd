# v0.8.0 Implementation Record

**Theme:** "Intelligence & Organisation" - Foundation
**Released:** 2025-12-03
**Duration:** ~4 hours

## Overview

v0.8.0 establishes the foundation for intelligent document organisation with Tag Provenance (F-064) and Data Sensitivity Tiers (F-018). These features prepare the groundwork for the intelligent tagging and retrieval enhancements planned for subsequent v0.8.x releases.

## Features Implemented

### F-064: Tag Provenance

Transform `ragd_tags` from simple strings to `TagEntry` objects with full provenance tracking.

**Changes:**
- Created `src/ragd/metadata/provenance.py` with `TagEntry` dataclass
- Tags now track: source, confidence, created_at, created_by
- Source types: manual, legacy, auto-keybert, auto-llm, auto-ner, imported
- Updated `TagManager` to work with `TagEntry` objects
- Added `tag_names` property for backward compatibility
- Schema migration v2.1 -> v2.2 converts string tags to `TagEntry` with "legacy" source

**TagEntry Sources:**
| Source | Description | Confidence |
|--------|-------------|------------|
| manual | User explicitly added | N/A |
| legacy | Migrated from pre-v2.2 | N/A |
| auto-keybert | KeyBERT keyword extraction | 0.0-1.0 |
| auto-llm | LLM classification | 0.0-1.0 |
| auto-ner | Named Entity Recognition | 0.0-1.0 |
| imported | Imported from archive | N/A |

### F-018: Data Sensitivity Tiers

Classify documents into sensitivity tiers with appropriate access controls.

**Changes:**
- Created `src/ragd/security/tiers.py` with `DataTier` enum
- Four tiers: public, personal (default), sensitive, critical
- `TierManager` for tier assignment and querying
- CLI commands: `ragd tier set/show/list/summary/promote/demote`
- Integration with session management for access control

**Tier Hierarchy:**
| Tier | Access | Description |
|------|--------|-------------|
| PUBLIC | Always | No authentication required |
| PERSONAL | Default | Basic password auth |
| SENSITIVE | Session | Requires active unlocked session |
| CRITICAL | Confirmed | Session + explicit confirmation |

## Schema Changes

### Schema Version 2.2

**New Fields:**
- `ragd_tags`: Changed from `list[str]` to `list[TagEntry]`
- `ragd_data_tier`: Data sensitivity classification (public/personal/sensitive/critical)

**Migration:**
- v2.1 -> v2.2: String tags converted to TagEntry with "legacy" source
- Sensitivity mapped: public->public, internal->personal, confidential->sensitive

## CLI Commands Added

```bash
# Tier management
ragd tier set <doc_id> <tier>       # Set document tier
ragd tier show <doc_id>             # Show document tier
ragd tier list [tier]               # List documents by tier
ragd tier summary                   # Tier distribution summary
ragd tier promote <doc_id>          # Increase sensitivity
ragd tier demote <doc_id>           # Decrease sensitivity
```

## Files Changed

### New Files
- `src/ragd/metadata/provenance.py` - TagEntry and helpers
- `src/ragd/security/tiers.py` - DataTier and TierManager
- `src/ragd/ui/cli/tiers.py` - CLI tier commands
- `tests/metadata/test_provenance.py` - Provenance tests
- `tests/security/test_tiers.py` - Tier tests

### Modified Files
- `src/ragd/__init__.py` - Version bump to 0.8.0
- `pyproject.toml` - Version bump to 0.8.0
- `src/ragd/metadata/schema.py` - Schema v2.2, new fields
- `src/ragd/metadata/migration.py` - v2.1->v2.2 migration
- `src/ragd/metadata/tags.py` - TagEntry integration
- `src/ragd/metadata/__init__.py` - New exports
- `src/ragd/security/__init__.py` - Tier exports
- `src/ragd/ui/cli/__init__.py` - Tier command exports
- `src/ragd/cli.py` - Tier command group

## Test Coverage

- 53 new tests for provenance and tiers modules
- All 1027+ existing tests continue to pass
- Schema migration tests updated for v2.2

## Dependencies

No new dependencies required. Uses existing:
- dataclasses (stdlib)
- datetime (stdlib)
- SQLite for storage

## What's Next

v0.8.0 sets the foundation for:
- **v0.8.1**: Smart Collections, Auto-Tag Suggestions, Tag Library
- **v0.8.2**: Reranking, Query Decomposition
- **v0.8.5**: Dual-Index Architecture, Knowledge Graph

## Related Documentation

- [F-064: Tag Provenance](../features/completed/F-064-tag-provenance.md)
- [F-018: Data Sensitivity Tiers](../features/completed/F-018-data-tiers.md)
- [v0.8.0 Implementation Plan](~/.claude/plans/rosy-skipping-babbage.md)

---

**Status**: Completed
