# v0.2.5 Retrospective

## Summary

v0.2.5 delivered F-039 (Advanced HTML Processing), extending v0.2's web capabilities with fast parsing, rich metadata extraction, and structure preservation.

**Duration:** 1 session (27 November 2025)
**Outcome:** Success with lessons learned - feature complete, version management gap identified

## What Happened vs Plan

### Planned Features

| Feature | Description | Status |
|---------|-------------|--------|
| F-039 | Advanced HTML Processing | Completed |

### Actual Execution

Implementation followed the plan:

1. **Extend existing `src/ragd/web/`** - Added parser.py, metadata.py, structure.py
2. **Tiered processing** - selectolax for simple pages, trafilatura for complex
3. **Rich metadata** - Open Graph, JSON-LD, Schema.org, Dublin Core, Twitter Cards
4. **Structure preservation** - Tables/headings/lists converted to Markdown
5. **Structure-aware chunking** - Respects heading boundaries, keeps tables intact

## Manual Interventions Required

1. **Version display fix** - `ragd --version` showed 0.2.1 after implementation
   - Root cause: `src/ragd/__init__.py` not updated when `pyproject.toml` changed
   - Required manual fix to both files

## Issues Found and Fixed

### Version Management (HIGH)

**Problem:** Version defined in two locations with no synchronisation guidance:
- `pyproject.toml` (updated to 0.2.5)
- `src/ragd/__init__.py` (remained at 0.2.1)

The CLI imports `__version__` from `__init__.py`, causing version display mismatch.

**Root Cause:** Workflow documentation only mentioned `pyproject.toml`, never `__init__.py`.

**Fix:**
- Updated both files to 0.2.5
- Added "Version Locations" section to `ragd/.claude/CLAUDE.md`
- Added version sync reference to `docs/development/process/workflow.md`
- Created pre-commit hook `scripts/check-version-sync.py`
- Created global templates in `~/.claude/templates/`

### Test Data Organisation (LOW)

**Problem:** Test HTML files were in `test_data/html/` but F-038 had moved archive files.

**Fix:** Reorganised test_data/ with proper structure and README.

## Documentation Drift Discovered

1. **Version status table** - CLAUDE.md still showed v0.2.0 as "Planned"
2. **Workflow version rules** - Missing dual-location version guidance

## What Worked Well

1. **Feature-centric test organisation** - `test_*.py` by module, `manual_v*.py` for UAT
2. **Tiered processing architecture** - Fast path for simple HTML, quality path for complex
3. **Graceful degradation** - Works without selectolax (falls back to BeautifulSoup)
4. **ADR documentation** - ADR-0025 captured architectural decisions clearly
5. **Comprehensive tests** - 78 new unit tests, manual UAT script

## Lessons Learned

1. **Version sync must be explicit** - Document ALL version locations, not just primary
2. **Pre-commit hooks catch drift** - Automated validation prevents human error
3. **Post-implementation verification** - Always run CLI `--version` as final check
4. **Checklists prevent omissions** - Pre/post implementation checklists are essential

## Action Items Completed

| Action | Status | Notes |
|--------|--------|-------|
| Add version sync to CLAUDE.md | Done | Dual locations documented |
| Add version sync to workflow.md | Done | Reference added |
| Create pre-commit hook | Done | `scripts/check-version-sync.py` |
| Create global templates | Done | `~/.claude/templates/` |
| Update implement-autonomously agent | Done | Pre-flight checks added |
| Add implementation checklists | Done | In `ragd/.claude/CLAUDE.md` |

## Process Improvements Made

1. **Pre-commit hook for version sync** - Blocks commits if versions mismatch
2. **Global templates** - Reusable checklists in `~/.claude/templates/`
3. **Agent pre-flight checks** - implement-autonomously now checks versions first
4. **Project checklists** - Pre/post implementation in `ragd/.claude/CLAUDE.md`

## Metrics

| Metric | Value |
|--------|-------|
| Features implemented | 1 (F-039) |
| New test count | 78 |
| Total tests | 393 passing |
| Manual interventions | 1 (version fix) |
| Process improvements | 6 |

---

**Status**: Completed
