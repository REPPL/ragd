"""Word validation and common word lists.

Provides word validation for text normalisation, using both
a bundled common words list and optional system dictionary.
"""

from __future__ import annotations

import os
from functools import lru_cache
from pathlib import Path

# Common English words for validation (top ~3000 words)
# This is a curated subset focused on words likely to appear in documents
COMMON_WORDS = frozenset(
    [
        # Articles, pronouns, prepositions
        "a",
        "an",
        "the",
        "i",
        "you",
        "he",
        "she",
        "it",
        "we",
        "they",
        "me",
        "him",
        "her",
        "us",
        "them",
        "my",
        "your",
        "his",
        "its",
        "our",
        "their",
        "mine",
        "yours",
        "hers",
        "ours",
        "theirs",
        "this",
        "that",
        "these",
        "those",
        "who",
        "whom",
        "whose",
        "which",
        "what",
        "in",
        "on",
        "at",
        "to",
        "for",
        "of",
        "with",
        "by",
        "from",
        "up",
        "down",
        "out",
        "off",
        "over",
        "under",
        "through",
        "between",
        "into",
        "during",
        "before",
        "after",
        "above",
        "below",
        "about",
        "against",
        "among",
        "around",
        "behind",
        "beside",
        "beyond",
        "near",
        "toward",
        "within",
        "without",
        # Conjunctions
        "and",
        "or",
        "but",
        "nor",
        "so",
        "yet",
        "if",
        "then",
        "because",
        "although",
        "unless",
        "while",
        "when",
        "where",
        "whether",
        "however",
        "therefore",
        "moreover",
        "furthermore",
        "nevertheless",
        "otherwise",
        "meanwhile",
        # Common verbs
        "be",
        "is",
        "am",
        "are",
        "was",
        "were",
        "been",
        "being",
        "have",
        "has",
        "had",
        "having",
        "do",
        "does",
        "did",
        "doing",
        "done",
        "will",
        "would",
        "shall",
        "should",
        "may",
        "might",
        "must",
        "can",
        "could",
        "go",
        "goes",
        "went",
        "gone",
        "going",
        "come",
        "comes",
        "came",
        "coming",
        "get",
        "gets",
        "got",
        "getting",
        "make",
        "makes",
        "made",
        "making",
        "take",
        "takes",
        "took",
        "taken",
        "taking",
        "see",
        "sees",
        "saw",
        "seen",
        "seeing",
        "know",
        "knows",
        "knew",
        "known",
        "knowing",
        "think",
        "thinks",
        "thought",
        "thinking",
        "say",
        "says",
        "said",
        "saying",
        "give",
        "gives",
        "gave",
        "given",
        "giving",
        "find",
        "finds",
        "found",
        "finding",
        "tell",
        "tells",
        "told",
        "telling",
        "ask",
        "asks",
        "asked",
        "asking",
        "use",
        "uses",
        "used",
        "using",
        "put",
        "puts",
        "putting",
        "keep",
        "keeps",
        "kept",
        "keeping",
        "let",
        "lets",
        "letting",
        "begin",
        "begins",
        "began",
        "begun",
        "beginning",
        "seem",
        "seems",
        "seemed",
        "seeming",
        "leave",
        "leaves",
        "left",
        "leaving",
        "call",
        "calls",
        "called",
        "calling",
        "need",
        "needs",
        "needed",
        "needing",
        "feel",
        "feels",
        "felt",
        "feeling",
        "become",
        "becomes",
        "became",
        "becoming",
        "want",
        "wants",
        "wanted",
        "wanting",
        "show",
        "shows",
        "showed",
        "shown",
        "showing",
        "try",
        "tries",
        "tried",
        "trying",
        "mean",
        "means",
        "meant",
        "meaning",
        "help",
        "helps",
        "helped",
        "helping",
        "start",
        "starts",
        "started",
        "starting",
        "run",
        "runs",
        "ran",
        "running",
        "move",
        "moves",
        "moved",
        "moving",
        "live",
        "lives",
        "lived",
        "living",
        "believe",
        "believes",
        "believed",
        "believing",
        "hold",
        "holds",
        "held",
        "holding",
        "bring",
        "brings",
        "brought",
        "bringing",
        "happen",
        "happens",
        "happened",
        "happening",
        "write",
        "writes",
        "wrote",
        "written",
        "writing",
        "provide",
        "provides",
        "provided",
        "providing",
        "read",
        "reads",
        "reading",
        "stand",
        "stands",
        "stood",
        "standing",
        "lose",
        "loses",
        "lost",
        "losing",
        "pay",
        "pays",
        "paid",
        "paying",
        "meet",
        "meets",
        "met",
        "meeting",
        "include",
        "includes",
        "included",
        "including",
        "continue",
        "continues",
        "continued",
        "continuing",
        "set",
        "sets",
        "setting",
        "learn",
        "learns",
        "learned",
        "learning",
        "change",
        "changes",
        "changed",
        "changing",
        "lead",
        "leads",
        "led",
        "leading",
        "understand",
        "understands",
        "understood",
        "understanding",
        "watch",
        "watches",
        "watched",
        "watching",
        "follow",
        "follows",
        "followed",
        "following",
        "stop",
        "stops",
        "stopped",
        "stopping",
        "create",
        "creates",
        "created",
        "creating",
        "speak",
        "speaks",
        "spoke",
        "spoken",
        "speaking",
        "allow",
        "allows",
        "allowed",
        "allowing",
        "add",
        "adds",
        "added",
        "adding",
        "spend",
        "spends",
        "spent",
        "spending",
        "grow",
        "grows",
        "grew",
        "grown",
        "growing",
        "open",
        "opens",
        "opened",
        "opening",
        "walk",
        "walks",
        "walked",
        "walking",
        "win",
        "wins",
        "won",
        "winning",
        "offer",
        "offers",
        "offered",
        "offering",
        "remember",
        "remembers",
        "remembered",
        "remembering",
        "love",
        "loves",
        "loved",
        "loving",
        "consider",
        "considers",
        "considered",
        "considering",
        "appear",
        "appears",
        "appeared",
        "appearing",
        "buy",
        "buys",
        "bought",
        "buying",
        "wait",
        "waits",
        "waited",
        "waiting",
        "serve",
        "serves",
        "served",
        "serving",
        "die",
        "dies",
        "died",
        "dying",
        "send",
        "sends",
        "sent",
        "sending",
        "expect",
        "expects",
        "expected",
        "expecting",
        "build",
        "builds",
        "built",
        "building",
        "stay",
        "stays",
        "stayed",
        "staying",
        "fall",
        "falls",
        "fell",
        "fallen",
        "falling",
        "cut",
        "cuts",
        "cutting",
        "reach",
        "reaches",
        "reached",
        "reaching",
        "kill",
        "kills",
        "killed",
        "killing",
        "remain",
        "remains",
        "remained",
        "remaining",
        "suggest",
        "suggests",
        "suggested",
        "suggesting",
        "raise",
        "raises",
        "raised",
        "raising",
        "pass",
        "passes",
        "passed",
        "passing",
        "sell",
        "sells",
        "sold",
        "selling",
        "require",
        "requires",
        "required",
        "requiring",
        "report",
        "reports",
        "reported",
        "reporting",
        "decide",
        "decides",
        "decided",
        "deciding",
        "pull",
        "pulls",
        "pulled",
        "pulling",
        # Common nouns
        "time",
        "year",
        "people",
        "way",
        "day",
        "man",
        "woman",
        "child",
        "children",
        "world",
        "life",
        "hand",
        "part",
        "place",
        "case",
        "week",
        "company",
        "system",
        "program",
        "question",
        "work",
        "government",
        "number",
        "night",
        "point",
        "home",
        "water",
        "room",
        "mother",
        "area",
        "money",
        "story",
        "fact",
        "month",
        "lot",
        "right",
        "study",
        "book",
        "eye",
        "job",
        "word",
        "business",
        "issue",
        "side",
        "kind",
        "head",
        "house",
        "service",
        "friend",
        "father",
        "power",
        "hour",
        "game",
        "line",
        "end",
        "member",
        "law",
        "car",
        "city",
        "community",
        "name",
        "president",
        "team",
        "minute",
        "idea",
        "body",
        "information",
        "back",
        "parent",
        "face",
        "others",
        "level",
        "office",
        "door",
        "health",
        "person",
        "art",
        "war",
        "history",
        "party",
        "result",
        "change",
        "morning",
        "reason",
        "research",
        "girl",
        "guy",
        "moment",
        "air",
        "teacher",
        "force",
        "education",
        "foot",
        "boy",
        "age",
        "policy",
        "process",
        "music",
        "market",
        "sense",
        "nation",
        "plan",
        "college",
        "interest",
        "death",
        "experience",
        "effect",
        "computer",
        "data",
        "file",
        "document",
        "text",
        "page",
        "content",
        "information",
        "knowledge",
        "section",
        "chapter",
        "table",
        "figure",
        "image",
        "example",
        "method",
        "analysis",
        "model",
        "theory",
        "approach",
        "source",
        "reference",
        "paper",
        "article",
        "journal",
        "review",
        "author",
        "title",
        "abstract",
        "introduction",
        "conclusion",
        "discussion",
        "results",
        "materials",
        "methods",
        "participants",
        "procedure",
        "design",
        "measure",
        "variable",
        "factor",
        "condition",
        "group",
        "sample",
        "population",
        "experiment",
        "hypothesis",
        "evidence",
        "finding",
        "observation",
        "pattern",
        "trend",
        "relationship",
        "correlation",
        "difference",
        "comparison",
        "contrast",
        "similarity",
        "category",
        "type",
        "class",
        "feature",
        "property",
        "characteristic",
        "attribute",
        "quality",
        "value",
        "score",
        "rate",
        "percentage",
        "average",
        "total",
        "amount",
        "quantity",
        "size",
        "length",
        "width",
        "height",
        "depth",
        "distance",
        "speed",
        "direction",
        "position",
        "location",
        "area",
        "region",
        "zone",
        "range",
        "limit",
        "boundary",
        "edge",
        "surface",
        "layer",
        "structure",
        "form",
        "shape",
        "pattern",
        "order",
        "sequence",
        "series",
        "list",
        "set",
        "collection",
        "array",
        "network",
        "connection",
        "link",
        "node",
        "path",
        "route",
        "step",
        "stage",
        "phase",
        "period",
        "cycle",
        "event",
        "action",
        "activity",
        "task",
        "project",
        "goal",
        "objective",
        "purpose",
        "function",
        "role",
        "status",
        "state",
        "condition",
        "situation",
        "context",
        "environment",
        "setting",
        "background",
        "basis",
        "foundation",
        "principle",
        "rule",
        "standard",
        "criterion",
        "requirement",
        "specification",
        "definition",
        "description",
        "explanation",
        "interpretation",
        "meaning",
        "concept",
        "notion",
        "term",
        "expression",
        "statement",
        "claim",
        "argument",
        "point",
        "issue",
        "problem",
        "solution",
        "answer",
        "response",
        "reaction",
        "feedback",
        "comment",
        "note",
        "remark",
        "suggestion",
        "recommendation",
        "advice",
        "guidance",
        "instruction",
        "direction",
        "command",
        "request",
        "question",
        "query",
        "search",
        "input",
        "output",
        "result",
        "outcome",
        "product",
        "resource",
        "tool",
        "technique",
        "strategy",
        "tactic",
        "option",
        "choice",
        "decision",
        "judgment",
        "assessment",
        "evaluation",
        "test",
        "check",
        "verification",
        "validation",
        "confirmation",
        "approval",
        "acceptance",
        "agreement",
        "consent",
        "permission",
        "access",
        "entry",
        "exit",
        "opening",
        "closing",
        "beginning",
        "ending",
        "start",
        "finish",
        "completion",
        "progress",
        "development",
        "improvement",
        "enhancement",
        "modification",
        "adjustment",
        "correction",
        "fix",
        "update",
        "revision",
        "version",
        "edition",
        "release",
        "publication",
        "distribution",
        "delivery",
        "transfer",
        "exchange",
        "transaction",
        "operation",
        "procedure",
        "practice",
        "application",
        "implementation",
        "execution",
        "performance",
        "behavior",
        "behaviour",
        "conduct",
        "manner",
        "style",
        "format",
        "layout",
        "arrangement",
        "organization",
        "organisation",
        "management",
        "administration",
        "control",
        "regulation",
        "supervision",
        "monitoring",
        "tracking",
        "recording",
        "documentation",
        "reporting",
        "communication",
        "presentation",
        "demonstration",
        "illustration",
        "representation",
        "visualization",
        "visualisation",
        "display",
        "view",
        "perspective",
        "angle",
        "aspect",
        "dimension",
        "component",
        "element",
        "unit",
        "module",
        "block",
        "section",
        "segment",
        "portion",
        "fraction",
        "share",
        "part",
        "piece",
        "item",
        "object",
        "entity",
        "instance",
        "occurrence",
        "case",
        "scenario",
        "situation",
        "circumstance",
        "opportunity",
        "possibility",
        "potential",
        "capability",
        "capacity",
        "ability",
        "skill",
        "competence",
        "expertise",
        "knowledge",
        "understanding",
        "awareness",
        "recognition",
        "identification",
        "detection",
        "discovery",
        "invention",
        "innovation",
        "creation",
        "production",
        "generation",
        "construction",
        "assembly",
        "installation",
        "setup",
        "configuration",
        "customization",
        "customisation",
        "adaptation",
        "integration",
        "combination",
        "merger",
        "separation",
        "division",
        "distribution",
        "allocation",
        "assignment",
        "designation",
        "selection",
        "extraction",
        "retrieval",
        "storage",
        "preservation",
        "protection",
        "security",
        "safety",
        "reliability",
        "stability",
        "consistency",
        "accuracy",
        "precision",
        "quality",
        "efficiency",
        "effectiveness",
        "productivity",
        "utility",
        "benefit",
        "advantage",
        "strength",
        "weakness",
        "limitation",
        "constraint",
        "restriction",
        "barrier",
        "obstacle",
        "challenge",
        "difficulty",
        "complexity",
        "simplicity",
        "clarity",
        "transparency",
        "visibility",
        "availability",
        "accessibility",
        "usability",
        "flexibility",
        "adaptability",
        "scalability",
        "extensibility",
        "maintainability",
        "sustainability",
        "durability",
        "longevity",
        "lifetime",
        "duration",
        "interval",
        "frequency",
        "occurrence",
        "incidence",
        "prevalence",
        "distribution",
        "spread",
        "coverage",
        "scope",
        "extent",
        "degree",
        "level",
        "intensity",
        "magnitude",
        "scale",
        "proportion",
        "ratio",
        "balance",
        "equilibrium",
        "harmony",
        "unity",
        "diversity",
        "variety",
        "multiplicity",
        "plurality",
        "majority",
        "minority",
        "exception",
        "anomaly",
        "deviation",
        "variation",
        "fluctuation",
        "oscillation",
        "transition",
        "transformation",
        "conversion",
        "translation",
        "interpretation",
        "rendering",
        "processing",
        "handling",
        "treatment",
        "management",
        # Common adjectives
        "good",
        "new",
        "first",
        "last",
        "long",
        "great",
        "little",
        "own",
        "other",
        "old",
        "right",
        "big",
        "high",
        "different",
        "small",
        "large",
        "next",
        "early",
        "young",
        "important",
        "few",
        "public",
        "bad",
        "same",
        "able",
        "full",
        "sure",
        "true",
        "false",
        "clear",
        "real",
        "best",
        "better",
        "free",
        "hard",
        "special",
        "easy",
        "strong",
        "certain",
        "simple",
        "several",
        "recent",
        "major",
        "main",
        "local",
        "social",
        "national",
        "available",
        "single",
        "specific",
        "particular",
        "general",
        "common",
        "current",
        "various",
        "individual",
        "significant",
        "similar",
        "likely",
        "possible",
        "necessary",
        "effective",
        "useful",
        "basic",
        "key",
        "essential",
        "critical",
        "primary",
        "secondary",
        "additional",
        "alternative",
        "original",
        "final",
        "complete",
        "direct",
        "positive",
        "negative",
        "natural",
        "normal",
        "typical",
        "usual",
        "proper",
        "appropriate",
        "relevant",
        "suitable",
        "adequate",
        "sufficient",
        "reasonable",
        "fair",
        "equal",
        "consistent",
        "accurate",
        "correct",
        "valid",
        "reliable",
        "stable",
        "secure",
        "safe",
        "clean",
        "fresh",
        "modern",
        "traditional",
        "standard",
        "conventional",
        "official",
        "formal",
        "informal",
        "professional",
        "technical",
        "practical",
        "theoretical",
        "academic",
        "scientific",
        "legal",
        "financial",
        "economic",
        "political",
        "cultural",
        "physical",
        "mental",
        "emotional",
        "personal",
        "private",
        "internal",
        "external",
        "global",
        "international",
        "regional",
        "central",
        "upper",
        "lower",
        "front",
        "back",
        "top",
        "bottom",
        "left",
        "middle",
        "initial",
        "previous",
        "subsequent",
        "following",
        "entire",
        "whole",
        "total",
        "overall",
        "maximum",
        "minimum",
        "average",
        "approximate",
        "exact",
        "precise",
        "detailed",
        "brief",
        "short",
        "quick",
        "fast",
        "slow",
        "rapid",
        "immediate",
        "instant",
        "constant",
        "continuous",
        "regular",
        "frequent",
        "occasional",
        "rare",
        "unique",
        "distinct",
        "separate",
        "independent",
        "dependent",
        "relative",
        "absolute",
        "perfect",
        "ideal",
        "optimal",
        "actual",
        "apparent",
        "obvious",
        "evident",
        "visible",
        "hidden",
        "unknown",
        "familiar",
        "strange",
        "complex",
        "complicated",
        "difficult",
        "tough",
        "challenging",
        "interesting",
        "exciting",
        "boring",
        "amazing",
        "wonderful",
        "beautiful",
        "nice",
        "fine",
        "excellent",
        "outstanding",
        "remarkable",
        "impressive",
        "valuable",
        "precious",
        "expensive",
        "cheap",
        "rich",
        "poor",
        "empty",
        "busy",
        "active",
        "passive",
        "open",
        "closed",
        "wide",
        "narrow",
        "deep",
        "shallow",
        "thick",
        "thin",
        "heavy",
        "light",
        "bright",
        "dark",
        "warm",
        "cold",
        "hot",
        "cool",
        "wet",
        "dry",
        "soft",
        "rough",
        "smooth",
        "sharp",
        "flat",
        "round",
        "straight",
        "crooked",
        "solid",
        "liquid",
        "raw",
        "pure",
        "mixed",
        "combined",
        "separate",
        "connected",
        "linked",
        "related",
        "associated",
        "corresponding",
        "matching",
        "compatible",
        "incompatible",
        "suitable",
        "unsuitable",
        "acceptable",
        "unacceptable",
        "satisfactory",
        "unsatisfactory",
        "successful",
        "unsuccessful",
        "complete",
        "incomplete",
        "finished",
        "unfinished",
        "ready",
        "prepared",
        "available",
        "unavailable",
        "present",
        "absent",
        "missing",
        "existing",
        "remaining",
        "outstanding",
        "pending",
        "ongoing",
        "continuing",
        "developing",
        "growing",
        "increasing",
        "decreasing",
        "rising",
        "falling",
        "expanding",
        "shrinking",
        "changing",
        "varying",
        "fixed",
        "permanent",
        "temporary",
        "provisional",
        "conditional",
        "unconditional",
        "mandatory",
        "optional",
        "voluntary",
        "compulsory",
        "required",
        "recommended",
        "suggested",
        "proposed",
        "planned",
        "scheduled",
        "expected",
        "anticipated",
        "predicted",
        "estimated",
        "calculated",
        "measured",
        "observed",
        "recorded",
        "reported",
        "documented",
        "published",
        "released",
        "distributed",
        "shared",
        "transmitted",
        "received",
        "accepted",
        "rejected",
        "approved",
        "denied",
        "granted",
        "refused",
        "allowed",
        "prohibited",
        "restricted",
        "limited",
        "unlimited",
        "controlled",
        "regulated",
        "managed",
        "administered",
        "operated",
        "maintained",
        "supported",
        "assisted",
        "helped",
        "guided",
        "directed",
        "led",
        "followed",
        "accompanied",
        "joined",
        "attached",
        "detached",
        "removed",
        "deleted",
        "added",
        "inserted",
        "included",
        "excluded",
        "omitted",
        "ignored",
        "considered",
        "examined",
        "reviewed",
        "analysed",
        "analyzed",
        "evaluated",
        "assessed",
        "tested",
        "checked",
        "verified",
        "validated",
        "confirmed",
        "certified",
        "qualified",
        "trained",
        "educated",
        "informed",
        "aware",
        "conscious",
        "sensitive",
        "responsive",
        "reactive",
        "proactive",
        "interactive",
        "collaborative",
        "cooperative",
        "competitive",
        "aggressive",
        "defensive",
        "protective",
        "preventive",
        "corrective",
        "constructive",
        "destructive",
        "creative",
        "innovative",
        "inventive",
        "original",
        "traditional",
        "conservative",
        "progressive",
        "radical",
        "moderate",
        "extreme",
        "severe",
        "mild",
        "slight",
        "minor",
        "trivial",
        "negligible",
        "marginal",
        "substantial",
        "considerable",
        "enormous",
        "huge",
        "massive",
        "vast",
        "immense",
        "tremendous",
        "extraordinary",
        "exceptional",
        "unusual",
        "uncommon",
        "rare",
        "scarce",
        "abundant",
        "plentiful",
        "numerous",
        "multiple",
        "double",
        "triple",
        "single",
        "sole",
        "only",
        "mere",
        "pure",
        "sheer",
        "utter",
        "total",
        "entire",
        "whole",
        "partial",
        "fractional",
        "proportional",
        "equal",
        "unequal",
        "even",
        "odd",
        "balanced",
        "unbalanced",
        "symmetric",
        "asymmetric",
        "parallel",
        "perpendicular",
        "vertical",
        "horizontal",
        "diagonal",
        "circular",
        "rectangular",
        "triangular",
        "spherical",
        "cylindrical",
        "conical",
        "cubic",
        "linear",
        "nonlinear",
        "exponential",
        "logarithmic",
        "polynomial",
        "quadratic",
        "random",
        "systematic",
        "sequential",
        "simultaneous",
        "concurrent",
        "consecutive",
        "successive",
        "alternate",
        "reciprocal",
        "mutual",
        "bilateral",
        "unilateral",
        "multilateral",
        # Common adverbs
        "not",
        "also",
        "very",
        "often",
        "however",
        "too",
        "usually",
        "really",
        "already",
        "early",
        "never",
        "always",
        "sometimes",
        "together",
        "likely",
        "simply",
        "generally",
        "instead",
        "actually",
        "finally",
        "quickly",
        "slowly",
        "probably",
        "clearly",
        "certainly",
        "definitely",
        "obviously",
        "apparently",
        "basically",
        "essentially",
        "primarily",
        "mainly",
        "mostly",
        "largely",
        "partly",
        "partially",
        "fully",
        "completely",
        "entirely",
        "totally",
        "absolutely",
        "exactly",
        "precisely",
        "approximately",
        "roughly",
        "nearly",
        "almost",
        "quite",
        "rather",
        "somewhat",
        "slightly",
        "highly",
        "extremely",
        "particularly",
        "especially",
        "specifically",
        "typically",
        "normally",
        "regularly",
        "frequently",
        "occasionally",
        "rarely",
        "seldom",
        "hardly",
        "barely",
        "merely",
        "only",
        "just",
        "even",
        "still",
        "yet",
        "again",
        "once",
        "twice",
        "often",
        "ever",
        "soon",
        "later",
        "now",
        "then",
        "today",
        "tomorrow",
        "yesterday",
        "here",
        "there",
        "everywhere",
        "nowhere",
        "somewhere",
        "anywhere",
        "away",
        "back",
        "forward",
        "backward",
        "upward",
        "downward",
        "inward",
        "outward",
        "aside",
        "apart",
        "alone",
        "together",
        "separately",
        "independently",
        "directly",
        "indirectly",
        "initially",
        "originally",
        "previously",
        "subsequently",
        "currently",
        "presently",
        "recently",
        "lately",
        "formerly",
        "ultimately",
        "eventually",
        "immediately",
        "instantly",
        "suddenly",
        "gradually",
        "steadily",
        "continuously",
        "constantly",
        "repeatedly",
        "alternatively",
        "otherwise",
        "accordingly",
        "consequently",
        "therefore",
        "thus",
        "hence",
        "thereby",
        "whereby",
        "meanwhile",
        "nonetheless",
        "nevertheless",
        "furthermore",
        "moreover",
        "additionally",
        "similarly",
        "likewise",
        "conversely",
        "contrary",
        "regardless",
        "anyway",
        "anyhow",
        "somehow",
        "perhaps",
        "maybe",
        "possibly",
        "presumably",
        "hopefully",
        "fortunately",
        "unfortunately",
        "surprisingly",
        "interestingly",
        "importantly",
        "significantly",
        "notably",
        "remarkably",
        "accordingly",
        "appropriately",
        "properly",
        "correctly",
        "accurately",
        "effectively",
        "efficiently",
        "successfully",
        "carefully",
        "thoroughly",
        "completely",
        "well",
        "badly",
        "poorly",
        # Numbers as words
        "zero",
        "one",
        "two",
        "three",
        "four",
        "five",
        "six",
        "seven",
        "eight",
        "nine",
        "ten",
        "eleven",
        "twelve",
        "thirteen",
        "fourteen",
        "fifteen",
        "sixteen",
        "seventeen",
        "eighteen",
        "nineteen",
        "twenty",
        "thirty",
        "forty",
        "fifty",
        "sixty",
        "seventy",
        "eighty",
        "ninety",
        "hundred",
        "thousand",
        "million",
        "billion",
        "trillion",
        "first",
        "second",
        "third",
        "fourth",
        "fifth",
        "sixth",
        "seventh",
        "eighth",
        "ninth",
        "tenth",
        # Technical/domain terms common in documents
        "algorithm",
        "application",
        "architecture",
        "authentication",
        "authorization",
        "automatic",
        "backup",
        "bandwidth",
        "binary",
        "browser",
        "buffer",
        "cache",
        "calculation",
        "certificate",
        "character",
        "client",
        "cloud",
        "cluster",
        "code",
        "command",
        "compilation",
        "compiler",
        "component",
        "compression",
        "computation",
        "configuration",
        "connection",
        "container",
        "controller",
        "conversion",
        "cookie",
        "core",
        "crash",
        "credential",
        "daemon",
        "dashboard",
        "database",
        "dataset",
        "debug",
        "default",
        "deployment",
        "desktop",
        "developer",
        "development",
        "device",
        "directory",
        "disk",
        "distributed",
        "docker",
        "domain",
        "download",
        "driver",
        "email",
        "embedding",
        "encryption",
        "endpoint",
        "engine",
        "enterprise",
        "entity",
        "entry",
        "environment",
        "error",
        "exception",
        "execution",
        "export",
        "extension",
        "extraction",
        "failure",
        "feature",
        "feedback",
        "field",
        "filter",
        "firewall",
        "firmware",
        "folder",
        "format",
        "framework",
        "frontend",
        "function",
        "gateway",
        "generation",
        "graph",
        "graphics",
        "handler",
        "hardware",
        "hash",
        "header",
        "heap",
        "hierarchy",
        "hostname",
        "hyperlink",
        "identifier",
        "image",
        "import",
        "index",
        "inference",
        "infrastructure",
        "initialisation",
        "initialization",
        "injection",
        "input",
        "instance",
        "instruction",
        "integer",
        "integration",
        "intelligence",
        "interface",
        "internet",
        "interpreter",
        "iteration",
        "javascript",
        "kernel",
        "keyboard",
        "keyword",
        "label",
        "language",
        "latency",
        "layer",
        "layout",
        "library",
        "license",
        "licence",
        "lifecycle",
        "link",
        "linux",
        "listener",
        "load",
        "localhost",
        "location",
        "log",
        "logger",
        "logging",
        "logic",
        "login",
        "loop",
        "machine",
        "macro",
        "maintenance",
        "management",
        "manager",
        "manifest",
        "mapping",
        "markdown",
        "markup",
        "matrix",
        "media",
        "memory",
        "merge",
        "message",
        "metadata",
        "method",
        "metric",
        "middleware",
        "migration",
        "mobile",
        "mode",
        "model",
        "modification",
        "module",
        "monitor",
        "monitoring",
        "mouse",
        "multiprocessing",
        "multithreading",
        "namespace",
        "navigation",
        "network",
        "node",
        "normalisation",
        "normalization",
        "notification",
        "null",
        "numeric",
        "object",
        "offline",
        "online",
        "operation",
        "operator",
        "optimisation",
        "optimization",
        "option",
        "orchestration",
        "output",
        "overflow",
        "overhead",
        "package",
        "packet",
        "page",
        "pagination",
        "parallel",
        "parameter",
        "parser",
        "parsing",
        "partition",
        "password",
        "patch",
        "path",
        "pattern",
        "payload",
        "performance",
        "permission",
        "persistence",
        "pipeline",
        "pixel",
        "placeholder",
        "platform",
        "plugin",
        "pointer",
        "policy",
        "pool",
        "port",
        "portal",
        "prefix",
        "preprocessing",
        "priority",
        "privacy",
        "procedure",
        "process",
        "processing",
        "processor",
        "production",
        "profile",
        "programming",
        "progress",
        "project",
        "prompt",
        "property",
        "protocol",
        "prototype",
        "provider",
        "proxy",
        "python",
        "query",
        "queue",
        "random",
        "range",
        "ranking",
        "rate",
        "reader",
        "realtime",
        "reboot",
        "record",
        "recovery",
        "recursion",
        "redirect",
        "redundancy",
        "reference",
        "refresh",
        "regex",
        "registration",
        "regression",
        "release",
        "reload",
        "remote",
        "render",
        "rendering",
        "replication",
        "repository",
        "request",
        "requirement",
        "resolution",
        "resource",
        "response",
        "restart",
        "restoration",
        "restriction",
        "retrieval",
        "retry",
        "return",
        "rollback",
        "root",
        "router",
        "routing",
        "runtime",
        "sandbox",
        "scalability",
        "scale",
        "scaling",
        "scan",
        "scanner",
        "scheduler",
        "scheduling",
        "schema",
        "scope",
        "screen",
        "script",
        "scripting",
        "scroll",
        "search",
        "security",
        "segment",
        "selection",
        "semantic",
        "sensor",
        "sequence",
        "serialisation",
        "serialization",
        "server",
        "service",
        "session",
        "setting",
        "setup",
        "shader",
        "shell",
        "shortcut",
        "shutdown",
        "signal",
        "signature",
        "simulation",
        "singleton",
        "site",
        "size",
        "snapshot",
        "socket",
        "software",
        "solution",
        "sorting",
        "source",
        "specification",
        "split",
        "spreadsheet",
        "sql",
        "stack",
        "staging",
        "standard",
        "startup",
        "statement",
        "static",
        "statistics",
        "status",
        "storage",
        "store",
        "stream",
        "streaming",
        "string",
        "structure",
        "stylesheet",
        "subdirectory",
        "submission",
        "subnet",
        "subroutine",
        "subscription",
        "suffix",
        "summary",
        "superuser",
        "support",
        "suspension",
        "symbol",
        "synchronisation",
        "synchronization",
        "syntax",
        "system",
        "table",
        "tag",
        "target",
        "task",
        "template",
        "tensor",
        "terminal",
        "termination",
        "test",
        "testing",
        "text",
        "thread",
        "threshold",
        "throughput",
        "timeout",
        "timestamp",
        "title",
        "token",
        "tokenisation",
        "tokenization",
        "tool",
        "toolbar",
        "tooltip",
        "trace",
        "tracing",
        "traffic",
        "training",
        "transaction",
        "transfer",
        "transformation",
        "transformer",
        "transition",
        "translation",
        "transmission",
        "tree",
        "trigger",
        "tuple",
        "type",
        "typing",
        "unicode",
        "update",
        "upgrade",
        "upload",
        "url",
        "usage",
        "user",
        "username",
        "utility",
        "utilisation",
        "utilization",
        "validation",
        "value",
        "variable",
        "vector",
        "vendor",
        "verification",
        "version",
        "versioning",
        "video",
        "view",
        "viewport",
        "virtual",
        "virtualisation",
        "virtualization",
        "virus",
        "visibility",
        "visualisation",
        "visualization",
        "volume",
        "warning",
        "web",
        "webhook",
        "website",
        "widget",
        "wiki",
        "wildcard",
        "window",
        "wizard",
        "word",
        "workflow",
        "workload",
        "workspace",
        "wrapper",
        "write",
        "writer",
        "xml",
        "yaml",
        "zone",
    ]
)


@lru_cache(maxsize=1)
def get_common_words() -> set[str]:
    """Get the set of common English words.

    Returns:
        Set of common words in lowercase
    """
    return set(COMMON_WORDS)


@lru_cache(maxsize=1)
def _get_system_dictionary() -> set[str] | None:
    """Try to load the system dictionary.

    Returns:
        Set of words from system dictionary, or None if not available
    """
    # Common locations for system dictionaries
    dict_paths = [
        "/usr/share/dict/words",  # Linux
        "/usr/share/dict/american-english",  # Debian/Ubuntu
        "/usr/share/dict/british-english",  # Debian/Ubuntu
        "/Library/Dictionaries/en.dictionary",  # macOS (not plain text)
    ]

    for dict_path in dict_paths:
        if os.path.isfile(dict_path):
            try:
                with open(dict_path, encoding="utf-8", errors="ignore") as f:
                    words = {line.strip().lower() for line in f if line.strip()}
                    return words
            except (OSError, PermissionError):
                continue

    return None


def is_valid_word(word: str, use_system_dict: bool = False) -> bool:
    """Check if a word is valid (exists in word lists).

    Args:
        word: Word to check (case-insensitive)
        use_system_dict: Whether to also check system dictionary

    Returns:
        True if word is valid
    """
    word_lower = word.lower()

    # Check common words first (fast)
    if word_lower in COMMON_WORDS:
        return True

    # Optionally check system dictionary
    if use_system_dict:
        system_dict = _get_system_dictionary()
        if system_dict and word_lower in system_dict:
            return True

    return False


def load_custom_wordlist(path: Path) -> set[str]:
    """Load a custom wordlist from a file.

    Args:
        path: Path to wordlist file (one word per line)

    Returns:
        Set of words in lowercase

    Raises:
        FileNotFoundError: If file doesn't exist
    """
    with open(path, encoding="utf-8") as f:
        return {line.strip().lower() for line in f if line.strip()}
